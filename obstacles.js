// obstacles.js - כולל את כל המכשולים, חיזוקים ושאלות ידע פיננסי במשחק

// מכשולים - השפעה חברתית שלילית
const negativeInfluenceObstacles = [
    {
        type: 'person',
        title: "השפעה חברתית שלילית",
        text: "חבר מציע לך לוותר על תוכנית החיסכון שלך כדי ליהנות יותר מההווה. כיצד תגיב?",
        value: 800, // עלות כספית אם מסכימים
        mentalEffect: 12, // פגיעה בבריאות מנטלית
        persuasiveTexts: [
            "מחקרים מראים שרוב האנשים לא מצליחים לחסוך בגלל מבנה מנטלי",
            "האם לא עדיף ליהנות מהכסף עכשיו במקום לחכות לעתיד לא בטוח?",
            "אתה נראה עייף, אולי תעשה לעצמך הפסקה קטנה מהחיסכון"
        ]
    },
    {
        type: 'person',
        title: "לחץ חברתי פיננסי",
        text: "חברים מזמינים אותך לחופשה יקרה שלא תכננת. מה תעשה?",
        value: 1200,
        mentalEffect: 10,
        persuasiveTexts: [
            "החופשה תהיה חוויה בלתי נשכחת, חבל לפספס",
            "כולם נוסעים, אתה באמת רוצה להישאר לבד?",
            "אתה עובד כל כך קשה, מגיע לך ליהנות קצת"
        ]
    },
    {
        type: 'person',
        title: "לחץ מצד המשפחה",
        text: "בני משפחה מבקשים ממך לממן אירוע משפחתי יקר. מה תעשה?",
        value: 1500,
        mentalEffect: 15,
        persuasiveTexts: [
            "משפחה היא הדבר החשוב ביותר, איך אתה יכול לסרב?",
            "כולם יחשבו שאתה קמצן אם לא תעזור במימון האירוע",
            "תמיד אפשר לחסוך אחר כך, משפחה זה פעם בחיים"
        ]
    },
    {
        type: 'person',
        title: "ביקורת על החיסכון",
        text: "עמית לעבודה מבקר את ההרגלים הפיננסיים החסכניים שלך. כיצד תגיב?",
        value: 600,
        mentalEffect: 8,
        persuasiveTexts: [
            "הוא טוען שאתה מפספס את החיים בגלל החיסכון המוגזם",
            "אולי באמת כדאי להוציא יותר כסף על בילויים כמו כולם?",
            "אתה באמת רוצה להיות ידוע כקמצן בקרב החברים?"
        ]
    }
];

// מכשולים - צריכה לא מתוכננת
const unplannedConsumptionObstacles = [
    {
        type: 'ad',
        title: "הצעה שיווקית מפתה",
        text: "נתקלת בהצעה שיווקית לגאדג'ט חדש שלא תכננת לקנות. מה תעשה?",
        value: 1200,
        persuasiveTexts: [
            "זו הזדמנות חד פעמית, המחיר לא יחזור על עצמו!",
            "הטכנולוגיה הזו תשפר את חייך ותחסוך לך זמן",
            "כל החברים שלך כבר קנו את זה, אתה באמת רוצה להישאר מאחור?"
        ]
    },
    {
        type: 'ad',
        title: "הנחה משמעותית",
        text: "ראית הנחה של 50% על מוצר שרצית, אבל לא תכננת לקנות עכשיו. מה תעשה?",
        value: 800,
        persuasiveTexts: [
            "אם תקנה עכשיו תחסוך 50%, זה בעצם רווח!",
            "המוצר עלול להיגמר במהרה, החלטה מהירה נדרשת",
            "אתה בטוח שתוכל למצוא מחיר טוב יותר בעתיד?"
        ]
    },
    {
        type: 'ad',
        title: "קניית בגדים",
        text: "אתה עובר ליד חנות שמציעה בגדים במחירים אטרקטיביים. מה תעשה?",
        value: 500,
        persuasiveTexts: [
            "המראה שלך חשוב לקריירה, זו השקעה חכמה",
            "אתה צריך בגדים חדשים בכל מקרה, למה לא לקנות עכשיו?",
            "המבצע יסתיים היום, אתה עלול לפספס הזדמנות טובה"
        ]
    },
    {
        type: 'ad',
        title: "מינוי חודשי חדש",
        text: "הוצע לך מינוי חודשי לשירות בידור חדש. מה תעשה?",
        value: 150, // עלות חודשית
        persuasiveTexts: [
            "זה רק 150 ש\"ח בחודש, סכום זניח בתקציב שלך",
            "כל החברים שלך כבר נרשמו, אתה לא רוצה להישאר מחוץ לשיחה?",
            "החודש הראשון חינם, אתה יכול תמיד לבטל אחר כך"
        ]
    }
];

// מכשולים - אוכל לא בריא
const unhealthyFoodObstacles = [
    {
        type: 'unhealthy-food',
        title: "פיתוי אוכל מהיר",
        text: "אתה עובר ליד מסעדת מזון מהיר וחש רעב. מה תעשה?",
        physicalEffect: 10, // פגיעה בבריאות פיזית
        mentalEffect: 5,   // פגיעה בבריאות מנטלית
        persuasiveTexts: [
            "זה רק פעם אחת, לא ישפיע כל כך על הבריאות שלך",
            "אתה עייף וזה חוסך לך זמן בהכנת ארוחה",
            "לפעמים מגיע לך להתפנק, אתה עובד כל כך קשה"
        ]
    },
    {
        type: 'unhealthy-food',
        title: "חטיפים וממתקים",
        text: "במהלך יום עבודה מלחיץ אתה רוצה לקנות חטיפים וממתקים. מה תעשה?",
        physicalEffect: 8,
        mentalEffect: 4,
        persuasiveTexts: [
            "אתה צריך את האנרגיה להמשך היום",
            "קצת סוכר יעזור לך להתרכז ולהיות יעיל יותר",
            "כולם מתפנקים מדי פעם, זה חלק מאיזון בריא"
        ]
    },
    {
        type: 'unhealthy-food',
        title: "ארוחת לילה",
        text: "אתה מרגיש רעב מאוחר בלילה ומתפתה להזמין אוכל שמן. מה תעשה?",
        physicalEffect: 12,
        mentalEffect: 6,
        persuasiveTexts: [
            "קשה לישון כשאתה רעב, זה יעזור לך לישון טוב יותר",
            "עדיף לאכול משהו מאשר ללכת לישון רעב",
            "מחר תאכל בריא יותר, זה רק הפעם"
        ]
    }
];

// מכשולים - אוכל מחוץ לבית
const eatingOutObstacles = [
    {
        type: 'eating-out',
        title: "הזמנת משלוח",
        text: "במקום לבשל בבית, אתה שוקל להזמין משלוח. מה תעשה?",
        value: 80, // עלות כספית
        persuasiveTexts: [
            "אתה עייף מדי היום, מגיע לך קצת מנוחה",
            "זה חוסך לך זמן שאתה יכול להשקיע במשהו אחר",
            "לפעמים הנוחות שווה את הכסף הנוסף"
        ]
    },
    {
        type: 'eating-out',
        title: "ארוחה במסעדה",
        text: "חברים מזמינים אותך לארוחה במסעדה יקרה. מה תעשה?",
        value: 200,
        persuasiveTexts: [
            "זו הזדמנות לבלות עם חברים, זה שווה את הכסף",
            "אתה לא רוצה לפספס את ההזדמנות החברתית הזו",
            "מגיע לך לצאת וליהנות מדי פעם"
        ]
    },
    {
        type: 'eating-out',
        title: "קפה ומאפה בדרך לעבודה",
        text: "אתה עובר ליד בית קפה בדרך לעבודה וחושב לקנות קפה ומאפה. מה תעשה?",
        value: 30,
        persuasiveTexts: [
            "זה יעזור לך להתעורר ולהתרכז בעבודה",
            "זה רק 30 שקלים, לא תרגיש את ההבדל בתקציב",
            "קפה טוב בבוקר משפר את מצב הרוח ליום שלם"
        ]
    }
];

// מכשולים - הצעות עבודה מפתות
const jobOfferObstacles = [
    {
        type: 'job-offer',
        title: "הזדמנות קריירה חדשה",
        text: "הוצעה לך עבודה עם שכר גבוה יותר אך פחות יציבות. מה תעשה?",
        value: 0, // ערך מיוחד - גורם להפסד אם מקבלים
        persuasiveTexts: [
            "האם אתה בטוח שברצונך לדחות הזדמנות זו?",
            "השכר גבוה ב-25% ותנאי הסוציאליים משופרים",
            "ההזדמנות להתפתחות מקצועית משמעותית יותר",
            "העבודה מציעה גמישות רבה יותר בשעות העבודה"
        ]
    }
];

// שאלות ידע פיננסי
const financialKnowledgeQuestions = [
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "לכמה אחוז מהאנשים בעולם יש יותר מ-100,000 דולר בחשבון הבנק?",
        correctAnswer: "10%",
        options: ["10%", "20%"],
        mentalEffect: 10, // פגיעה בבריאות מנטלית אם טועים
        explanation: "רק כ-10% מהאוכלוסייה העולמית מחזיקה יותר מ-100,000$ בחסכונות"
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "כמה כסף צריך לחסוך כל חודש החל מגיל 25 כדי להגיע למיליון ש\"ח בגיל 65?",
        correctAnswer: "כ-500 ש\"ח",
        options: ["כ-500 ש\"ח", "כ-2,000 ש\"ח"],
        mentalEffect: 10,
        explanation: "בהנחה של תשואה שנתית ממוצעת של 7%, חיסכון של כ-500 ש\"ח בחודש מגיל 25 יוביל למיליון ש\"ח בגיל 65."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "מהו שיעור ההוצאות המומלץ לדיור מתוך התקציב החודשי?",
        correctAnswer: "עד 30%",
        options: ["עד 30%", "עד 50%"],
        mentalEffect: 10,
        explanation: "מומחים ממליצים להוציא לא יותר מ-30% מההכנסה החודשית על דיור."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "כמה רצוי שיהיה בקרן החירום שלך?",
        correctAnswer: "3-6 חודשי הוצאות",
        options: ["3-6 חודשי הוצאות", "חודש הוצאות"],
        mentalEffect: 10,
        explanation: "קרן חירום בגובה 3-6 חודשי הוצאות מספקת רשת ביטחון מספקת למקרי חירום."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "קניית רכב חדש מהיבואן היא לרוב:",
        correctAnswer: "החלטה פיננסית לא יעילה",
        options: ["החלטה פיננסית לא יעילה", "השקעה טובה לטווח ארוך"],
        mentalEffect: 10,
        explanation: "רכב חדש מאבד כ-20%-30% מערכו בשנה הראשונה בלבד, לכן רכישת רכב 'יד שנייה' חסכונית יותר."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "מה אחוז המשפחות בישראל שיש להן חסכונות של יותר מ-100,000 ש\"ח?",
        correctAnswer: "פחות מ-30%",
        options: ["פחות מ-30%", "יותר מ-60%"],
        mentalEffect: 10,
        explanation: "פחות משליש מהמשפחות בישראל מחזיקות חסכונות של יותר מ-100,000 ש\"ח."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "האם ריבית דריבית משמעותית יותר בשנים הראשונות או האחרונות של ההשקעה?",
        correctAnswer: "בשנים האחרונות",
        options: ["בשנים האחרונות", "בשנים הראשונות"],
        mentalEffect: 10,
        explanation: "ריבית דריבית מייצרת תשואה גדולה יותר בשנים המאוחרות, כשהסכום הנצבר גדול יותר."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "מהי הדרך היעילה ביותר לצאת מחובות?",
        correctAnswer: "לשלם קודם חובות עם ריבית גבוהה",
        options: ["לשלם קודם חובות עם ריבית גבוהה", "לשלם קודם חובות קטנים"],
        mentalEffect: 10,
        explanation: "מבחינה מתמטית, כדאי לסגור קודם חובות עם ריבית גבוהה כדי לחסוך בתשלומי ריבית."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "כמה מהישראלים מגיעים לגיל הפרישה עם חסכונות מספיקים?",
        correctAnswer: "פחות מ-25%",
        options: ["פחות מ-25%", "יותר מ-50%"],
        mentalEffect: 10,
        explanation: "לפי נתוני הלמ\"ס, פחות מרבע מהישראלים מגיעים לגיל פרישה עם חסכונות מספיקים לפרישה נוחה."
    },
    {
        type: 'knowledge',
        title: "מבחן ידע פיננסי",
        text: "איזה אחוז מהמשכורת מומלץ לחסוך מדי חודש?",
        correctAnswer: "לפחות 20%",
        options: ["לפחות 20%", "לפחות 5%"],
        mentalEffect: 10,
        explanation: "מומחים פיננסיים ממליצים לחסוך לפחות 20% מההכנסה החודשית."
    }
];

// חיזוקים חיוביים
const positiveBoosts = [
    {
        type: 'earlyRise',
        title: "קימה מוקדמת",
        text: "האם קמת מוקדם היום?",
        mentalEffect: 10, // שיפור בריאות מנטלית
        // בריאות פיזית תשתפר ב-5 (מחצית מהמנטלית) - מוגדר בקוד המשחק
    },
    {
        type: 'earlySleep',
        title: "שינה מוקדמת",
        text: "האם הלכת לישון בזמן סביר אתמול?",
        mentalEffect: 15,
    },
    {
        type: 'healthyFood',
        title: "תזונה בריאה",
        text: "האם אכלת אוכל בריא ומאוזן היום?",
        physicalEffect: 15, // שיפור בריאות פיזית
        // בריאות מנטלית תשתפר ב-7.5 (מחצית מהפיזית) - מוגדר בקוד המשחק
    },
    {
        type: 'exercise',
        title: "פעילות גופנית",
        text: "האם ביצעת פעילות גופנית היום?",
        physicalEffect: 20,
    },
    {
        type: 'money',
        title: "הערכת ביצועים",
        text: "האם נתת סיבה החודש למנהל שלך לתת לך בונוס כספי?",
        value: 1500, // בונוס כספי פוטנציאלי
        followupQuestions: [ // שאלות המשך
            { 
                question: "האם הגעת לעבודה בזמן כל השבוע?", 
                positiveEffect: "אמינות ודייקנות הם ערכים חשובים למעסיק",
                negativeEffect: "איחורים פוגעים בתדמית המקצועית שלך"
            },
            { 
                question: "האם סיימת את כל המשימות שלך לפני הדדליין?", 
                positiveEffect: "עמידה ביעדים מוכיחה יעילות ומקצועיות",
                negativeEffect: "אי עמידה בזמנים פוגעת בהערכת הביצועים שלך"
            },
            { 
                question: "האם עזרת לעמיתים לעבודה השבוע?", 
                positiveEffect: "עבודת צוות טובה נלקחת בחשבון בהערכת עובדים",
                negativeEffect: "שיתוף פעולה מוגבל מקטין את הערך שלך לארגון"
            },
            { 
                question: "האם הבאת רעיון חדש או הצעת ייעול לעבודה?", 
                positiveEffect: "יוזמה ויצירתיות מובילות לקידום מקצועי",
                negativeEffect: "פסיביות בעבודה מגבילה את פוטנציאל הקידום שלך"
            },
            { 
                question: "האם השקעת זמן בהרחבת הידע המקצועי שלך?", 
                positiveEffect: "התפתחות אישית מגדילה את ערכך בשוק העבודה",
                negativeEffect: "קיבעון מקצועי מגביל את האפשרויות העתידיות שלך"
            }
        ]
    },
    {
        type: 'companion',
        title: "תמיכה חברתית",
        text: "האם אתה פתוח לקבל עזרה מאחרים בהתנהלות הפיננסית שלך?",
        mentalEffect: 15,
        physicalEffect: 15
    }
];

// מאגד את כל סוגי המכשולים יחד
const allObstacles = [
    ...negativeInfluenceObstacles,
    ...unplannedConsumptionObstacles,
    ...unhealthyFoodObstacles,
    ...eatingOutObstacles,
    ...jobOfferObstacles,
    ...financialKnowledgeQuestions
];

// ייצוא הפונקציות והנתונים שישמשו בקבצים אחרים
// מונע הופעת אותו סוג מכשול פעמיים ברצף
let lastObstacleType = '';

// פונקציה שמחזירה מכשול רנדומלי
function getRandomObstacle() {
    // מוודא שלא יופיע אותו סוג מכשול פעמיים ברצף
    let availableObstacles = allObstacles.filter(obstacle => obstacle.type !== lastObstacleType);
    
    // אם אין מספיק מכשולים, נאפס את המגבלה
    if (availableObstacles.length === 0) {
        availableObstacles = allObstacles;
    }
    
    // בחירת מכשול אקראי
    const randomIndex = Math.floor(Math.random() * availableObstacles.length);
    const selectedObstacle = availableObstacles[randomIndex];
    
    // שמירת הסוג האחרון
    lastObstacleType = selectedObstacle.type;
    
    return selectedObstacle;
}

// פונקציה שמחזירה חיזוק חיובי רנדומלי
function getRandomBoost() {
    const randomIndex = Math.floor(Math.random() * positiveBoosts.length);
    return positiveBoosts[randomIndex];
}
